sudo: false
language: php
php:
  - 7.1
services:
  - mysql
before_script:
# Get the token from github and put it in travis repo under GITHUB_COMPOSER_AUTH ENV variable, then uncomment line below.
#  - composer config -g github-oauth.github.com $GITHUB_COMPOSER_AUTH

# Below are necessary(?) commands for database creating. But they do not work.
  - composer install --no-interaction --prefer-dist

  - "wget https://goo.gl/s4o9Vx"
  - "java -jar selenium-server-standalone-3.4.0.jar > /dev/null &"
  - sleep 5
#  - "wget https://chromedriver.storage.googleapis.com/2.29/chromedriver_linux64.zip && unzip chromedriver_linux64.zip && sudo mv chromedriver /usr/bin"
script:
  - bin/console doctrine:database:create
  - bin/console doctrine:schema:update --force
#  - bin/console doctrine:fixtures:load -q
  - bin/console doctrine:database:create --env=test
  - vendor/bin/phpcs -p --standard=PSR2 --extensions=php ./src --ignore=*/DataFixtures/*
  - vendor/bin/codecept run acceptance
  - vendor/bin/phpunit

notifications:
  slack: nfqakademija:D39BmJYjiYZsrNylRdNfIBzm
