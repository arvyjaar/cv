sudo: false
language: php
php:
  - 7.1
services:
  - mysql
before_script:
# Get the token from github and put it in travis repo under GITHUB_COMPOSER_AUTH ENV variable, then uncomment line below.
#  - composer config -g github-oauth.github.com $GITHUB_COMPOSER_AUTH

  - composer install --no-interaction --prefer-dist
#  - phantomjs --webdriver=4444
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - sleep 3 # give xvfb some time to start
  - rackup  # start a Web server
  - sleep 3 # give Web server some time to bind to sockets, etc

script:
  - bin/console doctrine:database:create
  - bin/console doctrine:schema:update --force
#  - bin/console doctrine:fixtures:load -q
  - bin/console doctrine:database:create --env=test
  - vendor/bin/phpcs -p --standard=PSR2 --extensions=php ./src --ignore=*/DataFixtures/*
  - vendor/bin/phpunit
  - phantomjs testrunner.js
  - vendor/bin/codecept run

notifications:
  slack: nfqakademija:D39BmJYjiYZsrNylRdNfIBzm
